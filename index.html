<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ุณููุฑุฉ ุงููุฑุงุกุฉ ุงูุฐููุฉ - ุชุฑุดูุญ ูุชุจ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: "Tahoma", system-ui, sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #1f2937, #020617);
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .app {
      width: 100%;
      max-width: 900px;
      padding: 24px 16px 40px;
    }

    .card {
      background: linear-gradient(135deg, #020617, #0b1120);
      border-radius: 18px;
      padding: 20px 18px 18px;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148, 163, 184, 0.4);
      position: relative;
      overflow: hidden;
    }

    .header {
      text-align: center;
      margin-bottom: 18px;
    }

    /* ุญุงููุฉ ุงูุดุนุงุฑ ูุน ุฌูู ุจูุฌ */
    .logo-wrapper {
      width: 170px;
      height: 170px;
      margin: 0 auto 8px auto;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #fdf4e3, #e2c9a5);
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow:
        0 0 35px rgba(244, 220, 188, 0.95),
        0 0 80px rgba(248, 231, 210, 0.6);
      position: relative;
    }

    .logo-wrapper::before {
      content: "";
      position: absolute;
      inset: 8px;
      border-radius: 999px;
      border: 1px solid rgba(120, 85, 51, 0.15);
    }

    .main-logo {
      max-width: 75%;
      max-height: 75%;
      display: block;
      filter: drop-shadow(0 0 12px rgba(120, 85, 51, 0.35));
    }

    h1 {
      margin: 6px 0 2px;
      font-size: 24px;
      color: #f9fafb;
      letter-spacing: 1px;
    }

    .author-name {
      margin: 2px 0 0;
      font-size: 16px;
      color: #facc15; /* ุฐูุจู ูุงุนู */
      font-weight: 600;
    }

    .subtitle {
      margin: 4px 0 0;
      font-size: 14px;
      color: #a5b4fc;
      font-weight: 500;
    }

    .quote {
      margin-top: 10px;
      font-size: 13px;
      color: #cbd5f5;
      opacity: 0.9;
    }

    .quote span {
      color: #22d3ee;
      font-weight: 600;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 18px;
    }

    .field {
      flex: 1 1 140px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 13px;
      color: #e5e7eb;
    }

    label {
      opacity: 0.85;
    }

    select,
    input {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.8);
      color: #e5e7eb;
      outline: none;
    }

    select:focus,
    input:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.6);
    }

    .btn-row {
      margin-top: 16px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 9px 16px;
      font-size: 13px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #22d3ee);
      color: #0b1120;
      box-shadow: 0 10px 25px rgba(59, 130, 246, 0.45);
    }

    .btn-secondary {
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.8);
    }

    .btn-mini {
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding-inline: 10px;
      font-size: 11px;
    }

    .results {
      margin-top: 22px;
      display: grid;
      gap: 12px;
    }

    .result-title {
      font-size: 14px;
      color: #a5b4fc;
      opacity: 0.9;
    }

    .book-card {
      border-radius: 14px;
      padding: 12px 12px 8px;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.15), rgba(15, 23, 42, 1));
      border: 1px solid rgba(79, 70, 229, 0.5);
    }

    .book-tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 4px;
      font-size: 11px;
    }

    .tag {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: #e5e7eb;
    }

    .book-name {
      font-size: 15px;
      font-weight: 700;
      color: #f9fafb;
      margin-bottom: 3px;
    }

    .book-meta {
      font-size: 11px;
      color: #cbd5f5;
      margin-bottom: 4px;
    }

    .book-summary {
      font-size: 12px;
      color: #e5e7eb;
      opacity: 0.9;
      margin-bottom: 6px;
    }

    .book-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 4px;
    }

    .helper {
      margin-top: 10px;
      font-size: 11px;
      color: #9ca3af;
    }

    .helper span {
      color: #22d3ee;
    }

    .api-note {
      margin-top: 4px;
      font-size: 10px;
      color: #fbbf24;
    }

    .footer-sign {
      margin-top: 12px;
      font-size: 11px;
      text-align: left;
      color: #9ca3af;
      opacity: 0.95;
    }

    @media (max-width: 600px) {
      .card {
        padding: 16px 12px 14px;
      }
      h1 {
        font-size: 22px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <div class="header">

        <!-- ุดุนุงุฑ ูุจูุฑ ูุน ุฌูู ุจูุฌ -->
        <div class="logo-wrapper">
          <!-- ุบููุฑู logo.png ูุงุณู ููู ุงูุดุนุงุฑ ุนูุฏู -->
          <img src="logo.png" alt="ุดุนุงุฑ ูููุง ุจูุบูุซ" class="main-logo">
        </div>

        <h1>ุณููุฑุฉ ุงููุฑุงุกุฉ ุงูุฐููุฉ</h1>
        <div class="author-name">ูููุง ุจูุบูุซ</div>
        <div class="subtitle">ุชุฑุดูุญ ูุชุจ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู ูููุฑุญูุฉ ุงูุซุงูููุฉ</div>

        <p class="quote">
          ยซูุชุงุจู ูุงุญุฏู ูุฏ ูุบููุฑ ุนุงููุง ูุงูููุง ูู ุญูุงุชูุ 
          <span>ุงุฎุชุงุฑูู ุจุฐูุงุก</span> ุจูุณุงุนุฏุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู.ยป
        </p>
      </div>

      <!-- ูููุฐุฌ ุฅุฏุฎุงู ุจูุงูุงุช ุงูุทุงูุจุฉ -->
      <div class="form-row">
        <div class="field">
          <label for="grade">ุงูุตู ุงูุฏุฑุงุณู</label>
          <select id="grade">
            <option value="">ุงุฎุชุงุฑู ุงูุตู</option>
            <option value="10">ุงูุนุงุดุฑ</option>
            <option value="11">ุงูุญุงุฏู ุนุดุฑ</option>
            <option value="12">ุงูุซุงูู ุนุดุฑ</option>
          </select>
        </div>

        <div class="field">
          <label for="type">ููุน ุงููุชุงุจ</label>
          <select id="type">
            <option value="">ุงุฎุชุงุฑู ุงูููุน</option>
            <option value="ุฑูุงูุฉ">ุฑูุงูุฉ ุฃุฏุจูุฉ</option>
            <option value="ุชุทููุฑ ุฐุงุช">ุชุทููุฑ ุฐุงุช ูููุงุฑุงุช</option>
            <option value="ุนููู">ุนููู ูุจุณูุท</option>
            <option value="ุณูุฑุฉ">ุณูุฑุฉ ุฐุงุชูุฉ / ููููุฉ</option>
            <option value="ุฏููู">ุฏููู / ููููู</option>
          </select>
        </div>

        <div class="field">
          <label for="topic">ุนู ูุงุฐุง ุชุญุจูู ุฃู ุชูุฑุฆููุ (ุงุฎุชูุงุฑู)</label>
          <input id="topic" type="text" placeholder="ูุซุงู: ุชูุธูู ุงูููุชุ ุงูุตุฏุงูุฉุ ุงููุณุชูุจู..." />
        </div>
      </div>

      <div class="btn-row">
        <button class="btn-primary" onclick="smartRecommend()">
          ๐ ุงูุชุฑุดูุญ ุงูุฐูู ุงููุญูู
        </button>
        <button class="btn-secondary" onclick="clearResults()">
          โจ ุฅุนุงุฏุฉ ุถุจุท
        </button>
      </div>

      <div class="results" id="results">
        <div class="result-title">ุณุชุธูุฑ ููุง ุซูุงุซุฉ ุชุฑุดูุญุงุช ูุฎุตูุตุฉ ููู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนูโฆ</div>
      </div>

      <p class="helper">
        ูุนูู ูุฐุง ุงููููุน <span>ูุญููููุง</span> ุนูู ุฌูุงุฒู ูููู HTML ูุงุญุฏ.  
        ุฃุฒุฑุงุฑ <strong>ุชูุฎูุต GPT</strong> ุชุญุชุงุฌ ุฅูุชุฑูุช ูููุชุงุญ OpenAI.
      </p>
      <p class="api-note">
        โ๏ธ ูุง ุชุถุนู ููุชุงุญ OpenAI ูู ููู ููุดูุฑ ุนูู ุงูุฅูุชุฑูุช ุฃู ูุดุงุฑู ูุน ุงูุขุฎุฑูู.
      </p>

      <p class="footer-sign">
        ูุนููุฉ ุงููุบุฉ ุงูุนุฑุจูุฉ ยท ูููุง ุจูุบูุซ
      </p>
    </div>
  </div>

  <script>
    // ๐ ุถุนู ููุชุงุญ OpenAI ุงูุฎุงุต ุจู ููุง (ูุจูู ูู ุฌูุงุฒู ููุท)
    // ุฅุฐุง ุชุฑูุชูู ูุงุฑุบูุงุ ุฒุฑ GPT ูู ูุนูู.

    // ูุงุนุฏุฉ ุจูุงูุงุช ุจุณูุทุฉ ูููุชุจ (ูููููู ุชุนุฏูููุง ูุฅุถุงูุฉ ูุชุจ ุฃุฎุฑู)
    const books = [
      {
        title: "ุฑุฌุงู ูู ุงูุดูุณ",
        author: "ุบุณุงู ูููุงูู",
        type: "ุฑูุงูุฉ",
        grades: ["11", "12"],
        summary: "ุฑูุงูุฉ ูุตูุฑุฉ ุชุณูุท ุงูุถูุก ุนูู ุถูุงุน ุงูุฃุญูุงู ูุงูุจุญุซ ุนู ูุฑุตุฉ ุฃูุถูุ ุจุฃุณููุจ ุณูู ููุงูุนู.",
      },
      {
        title: "ุนุณุงูุฑ ููุณ ูุฒุญ",
        author: "ุฃูุฏุฑูุง ููุฑุงุชุง",
        type: "ุฑูุงูุฉ",
        grades: ["10", "11", "12"],
        summary: "ูุตุฉ ุทูุงุจ ูุฏุฑุณุฉ ูููุฑุฉ ูุฑุณููู ุฃุญูุงููุง ูุจูุฑุฉุ ุชุญููุฒ ุนูู ุงูุฅุตุฑุงุฑ ูุญุจ ุงูุนูู.",
      },
      {
        title: "ููุฉ ุงูุนุงุฏุงุช",
        author: "ุชุดุงุฑูุฒ ุฏููุบ",
        type: "ุชุทููุฑ ุฐุงุช",
        grades: ["11", "12"],
        summary: "ูุชุงุจ ูุดุฑุญ ููู ุชุชูููู ุนุงุฏุงุชูุง ูููู ูุบููุฑูุง ููุทููุฑ ุฃููุณูุง ุจุฎุทูุงุช ุจุณูุทุฉ.",
      },
      {
        title: "ุงูุทุงูุจ ุงูุนุจูุฑู",
        author: "ุฏ. ููุฏ ุงูุชููุฌุฑู",
        type: "ุชุทููุฑ ุฐุงุช",
        grades: ["10", "11", "12"],
        summary: "ุฏููู ุนููู ูุทุงูุจุฉ ุงูุซุงูููุฉ ูุชูุธูู ููุชูุง ูุฑูุน ุชุญุตูููุง ุงูุฏุฑุงุณู.",
      },
      {
        title: "ูุตุฉ ุงูููุฒูุงุก",
        author: "ุฌูู ุงูุฎูููู",
        type: "ุนููู",
        grades: ["11", "12"],
        summary: "ูุชุงุจ ูุฑูู ุชุทูุฑ ุนูู ุงูููุฒูุงุก ุจุฃุณููุจ ูุตุตู ููุชุน ุจุนูุฏ ุนู ุงูุชุนููุฏ.",
      },
      {
        title: "ุงูุนูู ูู ุญูุงุชูุง",
        author: "ูุฌููุนุฉ ูุคูููู",
        type: "ุนููู",
        grades: ["10", "11"],
        summary: "ููุฏู ุชุฌุงุฑุจ ูุฃูุซูุฉ ุจุณูุทุฉ ุชูุถุญ ููู ูุฏุฎู ุงูุนูู ูู ุชูุงุตูู ููููุง.",
      },
      {
        title: "ุฑุฌุงู ุญูู ุงูุฑุณูู",
        author: "ุฎุงูุฏ ูุญูุฏ ุฎุงูุฏ",
        type: "ุฏููู",
        grades: ["10", "11", "12"],
        summary: "ูุตุต ุตุญุงุจุฉ ููููุฉ ุชุนุฒุฒ ููู ุงูุดุฌุงุนุฉ ูุงูุตุจุฑ ูุงูุฅููุงู ูู ุญูุงุฉ ุงูุทุงูุจุฉ.",
      },
      {
        title: "ูุง ุชุญุฒู",
        author: "ุนุงุฆุถ ุงููุฑูู",
        type: "ุฏููู",
        grades: ["10", "11", "12"],
        summary: "ูุชุงุจ ูุจุนุซ ุงูุฃูู ูุงูุทูุฃูููุฉ ุจุฑุณุงุฆู ูุตูุฑุฉ ููุทููุฉ ููููุจ.",
      },
      {
        title: "ุฃูุง ููููุฉ",
        author: "ูุฌููุนุฉ ูุคูููู",
        type: "ุณูุฑุฉ",
        grades: ["10", "11", "12"],
        summary: "ุณูููุฑ ูุตูุฑุฉ ููุณุงุก ููููุงุช ูุฑููู ููู ูุงุฌูู ุงูุชุญุฏูุงุช ูุญููู ุฃุญูุงููู.",
      },
      {
        title: "ุณุชูู ุฌูุจุฒ",
        author: "ูุงูุชุฑ ุขูุฒูุณูู (ูุจุณุท)",
        type: "ุณูุฑุฉ",
        grades: ["11", "12"],
        summary: "ุณูุฑุฉ ููููุฉ ููุคุณุณ ุขุจูุ ุชุจุฑุฒ ููุฉ ุงูุดุบู ูุงูุฎูุงู ูู ุตูุงุนุฉ ุงููุณุชูุจู.",
      },
    ];

    function smartRecommend() {
      const grade = document.getElementById("grade").value;
      const type = document.getElementById("type").value;
      const topic = document.getElementById("topic").value.trim();

      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";

      if (!grade || !type) {
        resultsDiv.innerHTML =
          '<div class="result-title" style="color:#fca5a5;">ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุงูุตู ุงูุฏุฑุงุณู ูููุน ุงููุชุงุจ ุฃููุงู โ</div>';
        return;
      }

      // 1) ููุชุฑุฉ ุงููุชุจ ุญุณุจ ุงูุตู ูุงูููุน
      let filtered = books.filter(
        (b) => b.type === type && b.grades.includes(grade)
      );

      // 2) ุฅุฐุง ูู ููุถูุน ููุชูุจุ ููุถูู ุงููุชุจ ุงูุชู ููุงุณุจูุง ุงูููุถูุน
      if (topic) {
        const topicLower = topic.toLowerCase();
        const topicMatches = filtered.filter(
          (b) =>
            b.title.toLowerCase().includes(topicLower) ||
            b.summary.toLowerCase().includes(topicLower)
        );
        if (topicMatches.length > 0) {
          filtered = topicMatches;
        }
      }

      // 3) ุฅุฐุง ูุง ููููุง ูุชุจ ูุงููุฉุ ููุณุน ุงูุจุญุซ ุนูู ููุณ ุงูููุน ูุฌููุน ุงูุตููู
      if (filtered.length < 3) {
        const more = books.filter(
          (b) => b.type === type && !filtered.includes(b)
        );
        filtered = filtered.concat(more);
      }

      // 4) ุฅุฐุง ูุง ุฒุงูุช ุฃูู ูู 3ุ ูููู ุจุฃู ูุชุจ ููุงุณุจุฉ ููุตู
      if (filtered.length < 3) {
        const extra = books.filter(
          (b) => b.grades.includes(grade) && !filtered.includes(b)
        );
        filtered = filtered.concat(extra);
      }

      // 5) ุฃุฎุฐ ุฃูู 3 ููุท
      const top3 = filtered.slice(0, 3);

      if (top3.length === 0) {
        resultsDiv.innerHTML =
          '<div class="result-title">ูู ูุฌุฏ ุชุฑุดูุญุงุช ููุงุณุจุฉโฆ ุฌุฑูุจู ุชุบููุฑ ุงูููุน ุฃู ุงูุตู.</div>';
        return;
      }

      const intro = document.createElement("div");
      intro.className = "result-title";
      intro.textContent = "ูฃ ุชุฑุดูุญุงุช ุฐููุฉ ูุฎุตูุตุฉ ููู:";
      resultsDiv.appendChild(intro);

      top3.forEach((book, idx) => {
        const card = document.createElement("div");
        card.className = "book-card";

        const tags = document.createElement("div");
        tags.className = "book-tag-row";
        tags.innerHTML = `
          <span class="tag">ุชุฑุดูุญ ${idx + 1}</span>
          <span class="tag">ุงูุตู: ${grade}</span>
          <span class="tag">ููุน ุงููุชุงุจ: ${book.type}</span>
        `;

        const name = document.createElement("div");
name.className = "book-name";
name.textContent = book.title;

const meta = document.createElement("div");
meta.className = "book-meta";
meta.textContent = "ุงููุคูู: " + book.author;

        const summary = document.createElement("div");
        summary.className = "book-summary";
        summary.textContent = book.summary;

        const actions = document.createElement("div");
        actions.className = "book-actions";

        const googleBtn = document.createElement("button");
        googleBtn.className = "btn-mini";
        googleBtn.textContent = "๐ ุจุญุซ Google ุนู ุงููุชุงุจ";
        googleBtn.onclick = () => {
          const q = encodeURIComponent(book.title + " " + book.author);
          window.open("https://www.google.com/search?q=" + q, "_blank");
        };

        const gptBtn = document.createElement("button");
        gptBtn.className = "btn-mini";
        gptBtn.textContent = "๐ค ุชูุฎูุต ุฃุฐูู ูู GPT";
        gptBtn.onclick = () => summarizeWithGPT(book, summary, gptBtn);

        actions.appendChild(googleBtn);
        actions.appendChild(gptBtn);

        card.appendChild(tags);
        card.appendChild(name);
        card.appendChild(meta);
        card.appendChild(summary);
        card.appendChild(actions);
        resultsDiv.appendChild(card);
      });
    }

    function clearResults() {
      document.getElementById("grade").value = "";
      document.getElementById("type").value = "";
      document.getElementById("topic").value = "";
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML =
        '<div class="result-title">ุณุชุธูุฑ ููุง ุซูุงุซุฉ ุชุฑุดูุญุงุช ูุฎุตูุตุฉ ููู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนูโฆ</div>';
    }

async function summarizeWithGPT(book, summaryDiv, buttonEl) {
  // ุญูุงูุฉ ูู null (ุนุดุงู ูุง ูุทูุญ)
  if (!summaryDiv || !buttonEl) {
    console.error("ููู ุงูุชูุฎูุต: ูู ูุชู ุงูุนุซูุฑ ุนูู ุฒุฑ ุงูุชูุฎูุต ุฃู ููุงู ุนุฑุถ ุงูููุฎุต.");
    return;
  }

  const originalText = buttonEl.textContent;
  buttonEl.textContent = "โณ ุฌุงุฑู ุชูููุฏ ุงูุชูุฎูุต...";
  buttonEl.disabled = true;

  const title = (book?.title || "").trim() || "ุบูุฑ ูุญุฏุฏ";
  const author = (book?.author || "").trim() || "ุบูุฑ ูุญุฏุฏ";
  const type = (book?.type || "").trim() || "ุบูุฑ ูุญุฏุฏ";

  const prompt = `
ุฃูุช ูุณุงุนุฏ ุฃููู ูููุชุจุฉ ูููุฑุญูุฉ ุงูุซุงูููุฉ.
ุฃุฑูุฏ ููู ุชูุฎูุต ูุชุงุจ ููุทุงูุจุงุช ุจุนุจุงุฑุงุช ุนุฑุจูุฉ ุณููุฉ ุฌุฏุงู ูู ูฃ ุฅูู ูค ุฌูู.
ุงูุจูุงูุงุช:
ุงูุนููุงู: ${title}
ุงููุคูู: ${author}
ุงูููุน: ${type}

ุงูุชุจ ุงูุชูุฎูุต ูุจุงุดุฑุฉ ุจุฏูู ุนูุงููู ุงุถุงููุฉ ููุง ููุงุตู ุฒุฎุฑููุฉ.
`.trim();

  try {
    const response = await fetch("/api/summarize", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        text: prompt,
        title: title,
        author: author
      })
    });

    const data = await response.json();

    if (!response.ok) {
      console.error(data);
      alert(data?.error || "ุตุงุฑ ุฎุทุฃ ุจุงูุชูุฎูุต");
      return;
    }

    // โ ุงูุตุญูุญ ูุน API ุงููู ูุฑุฌุน { summary: ... }
    summaryDiv.textContent = (data.summary || "").trim() || "ูู ูุชู ุชูููุฏ ููุฎุต.";

  } catch (err) {
    console.error(err);
    alert("ุชุนุฐุฑ ุงูุงุชุตุงู. ุชุฃูุฏู ูู ุงูุฅูุชุฑูุช ูุฅุนุฏุงุฏุงุช .");
  } finally {
    buttonEl.textContent = originalText;
    buttonEl.disabled = false;
  

  
}      
    }
  </script>
</body>
</html>
